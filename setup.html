<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Counsel Group | إضافة حساب إدارة</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&family=Tajawal:wght@300;400;500;700&display=swap"
        rel="stylesheet">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-auth-compat.js"></script>

    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #0a0a0a;
            color: #ffffff;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>

<body class="selection:bg-yellow-600 selection:text-white flex items-center justify-center min-h-screen">

    <div class="glass-card p-8 rounded-2xl w-full max-w-md">
        <h2 class="text-2xl font-bold text-yellow-500 mb-6 text-center">إضافة مستخدم جديد</h2>
        <form id="setup-form" class="space-y-6">
            <div>
                <label class="block text-gray-400 text-sm mb-2">اسم المستخدم (سيكون الإيميل تلقائياً @gmail.com)</label>
                <input type="text" id="new-user"
                    class="w-full p-3 bg-[#021024] border border-gray-700 rounded-lg text-white focus:border-yellow-500 outline-none"
                    placeholder="مثال: admin" required>
            </div>
            <div>
                <label class="block text-gray-400 text-sm mb-2">كلمة المرور</label>
                <input type="password" id="new-pass"
                    class="w-full p-3 bg-[#021024] border border-gray-700 rounded-lg text-white focus:border-yellow-500 outline-none"
                    placeholder="••••••••" required>
            </div>
            <button type="submit"
                class="w-full py-3 bg-green-600 text-white font-bold rounded-lg hover:bg-green-500 transition">إنشاء
                الحساب</button>
        </form>
        <div id="status-msg" class="mt-4 text-center text-sm font-bold"></div>

        <div class="mt-6 border-t border-gray-700 pt-4 text-center">
            <a href="admin.html" class="text-blue-400 hover:text-blue-300">الذهاب لصفحة الأدمن</a>
        </div>
    </div>

    <script src="firebase-config.js"></script>
    <script>
        // auth is already initialized in firebase-config.js

        document.getElementById('setup-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const u = document.getElementById('new-user').value;
            const p = document.getElementById('new-pass').value;
            const msg = document.getElementById('status-msg');

            // Auto-append gmail logic same as admin.html
            const email = u.includes('@') ? u : `${u}@gmail.com`;

            msg.innerText = 'جاري الإنشاء...';
            msg.className = 'mt-4 text-center text-sm font-bold text-yellow-500';

            auth.createUserWithEmailAndPassword(email, p)
                .then((userCredential) => {
                    msg.innerText = `تم إنشاء الحساب بنجاح! اسم المستخدم: ${u}`;
                    msg.className = 'mt-4 text-center text-sm font-bold text-green-500';
                    document.getElementById('setup-form').reset();
                })
                .catch((error) => {
                    console.error(error);
                    let errorText = error.message;
                    if (error.code === 'auth/email-already-in-use') errorText = 'هذا المستخدم موجود بالفعل.';
                    if (error.code === 'auth/weak-password') errorText = 'كلمة المرور ضعيفة جداً.';

                    msg.innerText = `خطأ: ${errorText}`;
                    msg.className = 'mt-4 text-center text-sm font-bold text-red-500';
                });
        });
    </script>
</body>

</html>